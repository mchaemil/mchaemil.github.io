---
layout: article
title: Database/Data | NoSQL - MongoDB 란 무엇인가?
tags: NoSQL
comments: true

---

## **Today What I Learend**  

한국사회에서의 개발자 시장에 대해서 이야기 하나
SQL에 대한 리뷰 및 SQL이 NoSQL과 갖는 차이
MongoDB의 설치 과정에 대해서

MongoDB

개발자들이 MongoDB를 사용하는 이유는 
직관적인 데이터 모델 때문일 것이다. MongoDB는 정보를 행(row) 대신에 도큐먼트(document)에 저장한다. 

도큐먼트(document)의 데이터 구조는 한 개 이상의 key-value 쌍으로 되어 있다. 

MongoDB의 구조

```
<SERVER>
│
├<Database>
│ ├──<collection>
│ │   ├── document
│ │   ├── document
│ │   ├── document
│ │   └── document
│ │
│ └──<collection>
│     ├── document
│     ├── document
│     └── document
```


---
**Today I Learend**

- 준비단계
- SQL과의 비교
- 
- MongoDB 환경설정
- MongoDB 첫 번째 insert

---



### RDBMS와의 차이점

### RDBMS의 특징


relation => Entity (사용자와의 릴레이션이 아니라 ㅠㅠㅠ)
릴레이션과 릴레이션쉽과 혼동하면 안된다. 

SQL 

Adboe 쿼리...!

고급 사용자...!
최종사용자, end 유저들도 많이 활용한다. 

관계형 데이터 베이스는 정규화라는 과정을 거친다. 



게임도 결국 운영되기 위해서는 데이터가 필요하다
급여명세서를 구성하고 있는 
사번, 복리후생, 근퇴, 휴가일수, 기본급 등...!

> 모든 시스템에는 데이터베이스가 존재한다. 모습은 다르나 데이터베이스의 역할을 이해해야 데이터베이스를 만들 수 있다. 

RDBMS는 한 행(row)이라는 레코드 정보를 근간으로 해서 
데이터 구조를 만들고
한 행에는 여러개의 컬럼, 필드(각종 제약 정보를 정의한 것, 데이터 타입, 길이, 동일한 제약 조건, 이러한 여러개의 컬럼으로 구성되고 있는 로우를 가지고 프라이머리키를 만든다.)

프라이머리키로 적당한 컬럼은 not null, unique 여야하는 조건을 가지고 있다. 



변경가능성으로 인해 프라이머리키의 설정가능성이 있다. 
그러므로 이러한 데이터에는 pk를 하지 않는다. 


실제로 20년 전에는 PK를 주민등록번호로 사용한 경우도 있었지만 거의 쓰이지 않는다. 주민등록 번호는 완벽하지 않다.


#### 주민등록번호, 사번, 휴대폰번호, 이메일


PK는 행을 구분한다.

RDBMS에서 종속성을 익히게 되면
Y -> X 처럼 기술할 수 있게 된다. 

Y키 X값
함수적 종속성(functional Dependency) 
관계형 데이터베이스에서는 수학의 관계 대수에서 만들어졌다.

함수 종속성의 문제가 발생하지 않아야 한다. 

Y에 의해서 X가 결정된다.

주문 -< 주문 내역
1:N
관계 내역이 만들어진다.
중복을 제거하는 분해가 연속적으로 일어난다. 

2nd NF
3rd NF
최소한 써드 노멀폼까지 가도록...!
보이스코드 노멀폼전까지 보통 분해를 한다.

처음에 한 덩어리였던 것을 써드 노멀폼까지 분해하는 과정을 거친다...!!
보이스 코드나 써드 노멀폼 까지 분해를 한다. 
분해를 해서 가면 데이터의 중복이 없어진다.

> 데이터의 품질을 저해하는 가장 큰 원인이 데이터의 중복이다. 중복은 일관성의 문제를 일으킨다. 

> 프라이머리키는 데이터를 연결하는데 사용된다. 즉, 조인하기 위해서는 PK가 필요하다. 이러한 이유에서 관계형 데이터베이스에 조인이 없다는 건 모델을 잘못만들었다는 걸 뜻한다. 





#### 컬럼 간의 같은 값을 연결하는 게 조인이다. 
가령, 12억명을 출생지별로 묶는 조인을 해야 할 때 큰 비용이  발생하는 건 자명한 사실이다. 

이렇게 같은 사람끼리 묶는 조인을 해야 한다면 
FK를 만들 때는 `CREATE INDEX` 를 해야 한다

데이터를 다 뒤져보는 행위를 Full Scan이라고 하는 데, Full Scan 을 통해서 원하는 값을 찾는 건 데이터가 커질수록 비용이 많이 든다.

데이터가 클수록 인덱스가 있는 구조와 없는 구조는 데이터를 찾늗 데 있어서 비용이 하늘과 땅 차이로 벌어진다.


인덱스라는 매커니즘을 이해하지 못하고 코드를 작성하지 못하면
쿼리문은 쓰레기가 된다. 즉, 어떤 쿼리를 입력했을 때 6초 뒤에나 가져오는 경우라면...


#### index!!
비교우위에 서려면 인덱스를 활용할 수 있는 능력이 중요하다
질문을 몇개해보면
DB를 다루어봤는지 아닌지 알 수 있다.

인덱스에 관한 질문에 대해서 준비를 해야 한다.

#### JOIN
EQ 조인
PK와 FK를 활용해서 연결하는 게 조인이다.

Foreign Key에 인덱스가 안 걸려 있다면

> 관게형 데이터베이스는 조인을 안하는 경우가 없다
데이터를 보기 위해서는 데이터를 다 보아야 한다.


#### 주문서 데이터를 분리하는 게 노말라이제이션




#### 트랜잭션..

쪼개지면... 탈이 난다.
가령, 이체를 한 경우
예금과 인출


#### 롤백이라는 용어를 알았다면 트랜잭션을 이해했다는 것
ROllBACK은 트랜잭션을 뒤로 돌리는 것이다.
DML을 사용하기 이전의 행위로 돌리는 것을 ROLLBACK이다. 

데이터의 일관성의 문제가 발생했을 때 ROLLBACK을 한다. 


#### 데이터의 일관성
원래 상태로 돌려놓는 매커니즘이 트랜잭션이다...
이러한 트랜잭션의 관리가 매우 중요한데


#### 장바구니를 분석해야 해서 디비에 넣는다.


현업에서는 오토 커밋을 쓰지 않는다.
오토커밋은 DML을 입력하면 바로 데이터가 들어가는 것을 일컫는다.


복수의 값을 갖는 경우에는 노말라이제이션을 했는데
문서의 경우에는 그냥 집어넣을 수 있다. 


관계형 데이터베이스를 쓰는 경우에는 조인을 안 해도 된다. 



모델을 설계할 때 분리해야 한다.


네프 구조를 만들어서 쓸 수 있다. 



### 가장 큰 차이
관계형 데이터 베이스는 다대다가 안되지만
NoSQL은 다대다가 된다. 

관계형 데이터 베이스는 거쳐야 한다. 
가운데 테이블 하나가 껴야 하는데, 이 녀석을 
어소세이티브 Entity 라고 한다. 연관 엔티티...! 




### 사전 정의가 없다.

이것에 대한 묶음을 collection 
스키마가 없다보니 제약이 없다.


서로 다른 구조의 키를 가지고 있어도 문제가 없다.

보통 일반적으로 쓸 떄 다 다

개발할 때 더 편하다.
그래서 상당히 빠르게 개발할 수 있다는 장점이 있다. 
스키마가 없음으로 인해 너무 자유롭다.
통제가 잘 안된다.




콜렉션은 도큐멘트의 묶음 
함수를 넘겨줄 때 제이슨 형식의 정보를 넘겨준다.
컴마로 구성되어 있으면 and





#### 인덱스를 쓰는 이유
인덱스는 데이터가 많을 때 경제성이 뛰어나다.
인덱스의 구조는 B-트리이다. 



#### Scale Up VS Scale Down 

스케일 아웃을 했을 때는
Sharding 샤딩이 필요하다
데이터를 내가 인서트를 합니다. 

분산데이터베이스를 구현할 때 사용하는 방법
그래야 옆으로 계속 확장할 수 있다. 

Shard1, Shard2, Shard3


몽고디비는 스케일 아웃하기에 좋은 구조를 가지고 있다. 

문서의 구조가 내포형이라면 
문서형 데이터베이스를 쓰는 게 좋다.
관계형 DB보다 훨씬 큰 특징을 지니고 있다. 


#### 서버 환경이 대부분이 리눅스이다..
...! 그래서 리눅스를 쓰는 것을 추천한다.


환경변수 설정하기 
설정 후에는...! 프롬프트를 재시작해야 한다.
mongod.exe 실행 후 
mongo.exe  실행하기 그러면 > 가 뜸


최초 다큐멘트가 콜렉션에 저장이 되면...!
최초의 다큐멘트가 만들어지면 그 때
만들어진다.! 

기본적으로 필요한 시스템 데이터베이스이다. 



#### 맴캐시디..!

맴캐시디가 Reddis로 대체되는 경향이 크다. 
아주 간단한 키와 벨류로 저장하는 데이터베이스다

**맴캐시디**
구조가 키와 값 구조로만 되어있다.
키만 알면 값을 꺼낼 수 있는 구조이다. 

맴: 메모리
캐쉬: 읽기 속도를 높이기 위해서 사용하는 매커니즘 
디: 저장장치


메모리 데이터베이스로 사용하는 것을 말한다. 
메모리에 올리면 빠르니까...!

리악은 팔로잉, 팔로워할 떄 주로 쓰인다.
리악은 그래프 데이터베이스이다.


 Column Based 스토리지 
 

관계형 데이터베이스는 행기반인데 반해
Column Based 스토리지는 컬럼 기반으로 저장한다.

대용량 데이터 처리를 할 때 카산드라를 주로 사용한다.
컬럼별로 정렬되어 있을 때...!, 

주로 수직적인 확장을 하는데 유리하다. 
마이에스큐엘은 

다큐먼트 구조느 내포구조
문서를 표현하는 구조는 JSON
그리고 JSON에 익숙해지면서
자바스크립트의 객체 접근법을 가지고 데이터에 접근해야 한다. 

내가 필요한 데이터, 즉 내포구조를 가지고 있으므로 
조인을 안 해도 된다.

조인을 안 하고도 원하는 결과를 얻을 수  있다.

100% 조인을 안하는 결과를 얻을 수 있는가?
그것은 아니다!!

참조에 대한 매커니즘을 문서참조라고 해서 들어갈 수 있다. 
정규화되어 있는 관계형 모델보다는
조인 연산이 줄어드는 부분은 분명하다.


NoSQL의 경우 트랜잭션을 지원하지 않는 경우가 있는데
몽고디비는 지원을 한다
만약 디비에서 지원을 안 해준다면
애플리케이션 차원에서 그 기능을 만들어야 한다. 


데이터 베이스는 키와 값으로 구성이 된다!!
그래서...! 


predicate

